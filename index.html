<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>3D Scene – balls</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: radial-gradient(circle at 50% 0%, #16284a 0%, #02030a 55%, #000000 100%);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #8a94b5;
    }

    #container {
      position: fixed;
      inset: 0;
    }

    canvas {
      display: block;
    }

    .hint {
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      opacity: 0.55;
      pointer-events: none;
      user-select: none;
    }
  </style>

  <!-- *** ÖNCE three.js ve ekleri – type="module" YOK *** -->
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.160.0/examples/js/controls/OrbitControls.js"></script>
  <script src="https://unpkg.com/three@0.160.0/examples/js/loaders/GLTFLoader.js"></script>
</head>
<body>
  <div id="container"></div>
  <div class="hint">MOVE YOUR MOUSE · DRAG · SCROLL</div>

  <script>
    // ---------- TEMEL SAHNE ----------
    const container = document.getElementById('container');

    const scene = new THREE.Scene();
    scene.fog = new THREE.FogExp2(0x000000, 0.16);

    const camera = new THREE.PerspectiveCamera(
      45,
      window.innerWidth / window.innerHeight,
      0.1,
      50
    );
    camera.position.set(0, 0.8, 4);

    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.outputEncoding = THREE.sRGBEncoding;
    container.appendChild(renderer.domElement);

    // ---------- IŞIKLAR ----------
    const hemi = new THREE.HemisphereLight(0xffffff, 0x0b1020, 1.0);
    hemi.position.set(0, 2, 0);
    scene.add(hemi);

    const dir = new THREE.DirectionalLight(0xffffff, 1.2);
    dir.position.set(3, 4, 2);
    dir.castShadow = true;
    scene.add(dir);

    // Hafif rim ışık
    const rim = new THREE.DirectionalLight(0x88b5ff, 0.8);
    rim.position.set(-2, 1, -3);
    scene.add(rim);

    // ---------- KONTROLLER ----------
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.06;
    controls.enablePan = false;
    controls.minDistance = 2.2;
    controls.maxDistance = 6;
    controls.minPolarAngle = Math.PI * 0.2;
    controls.maxPolarAngle = Math.PI * 0.8;

    // ---------- GLB MODELLER ----------
    const loader = new THREE.GLTFLoader();
    const group = new THREE.Group();
    scene.add(group);

    // Bu dosyalar repo root’unda: christmas_ball.glb, christmas_tree_ball.glb
    loader.load(
      'christmas_ball.glb',
      (gltf) => {
        const ball = gltf.scene;
        ball.position.set(-0.9, 0, 0);
        ball.scale.set(1.1, 1.1, 1.1);
        ball.traverse(obj => {
          if (obj.isMesh) {
            obj.castShadow = true;
            obj.receiveShadow = true;
            if (obj.material) {
              obj.material.metalness = 0.7;
              obj.material.roughness = 0.3;
            }
          }
        });
        group.add(ball);
      },
      undefined,
      (err) => console.error('christmas_ball.glb yüklenemedi:', err)
    );

    loader.load(
      'christmas_tree_ball.glb',
      (gltf) => {
        const treeBall = gltf.scene;
        treeBall.position.set(0.9, -0.2, 0.1);
        treeBall.scale.set(1.1, 1.1, 1.1);
        treeBall.traverse(obj => {
          if (obj.isMesh) {
            obj.castShadow = true;
            obj.receiveShadow = true;
            if (obj.material) {
              obj.material.metalness = 0.65;
              obj.material.roughness = 0.35;
            }
          }
        });
        group.add(treeBall);
      },
      undefined,
      (err) => console.error('christmas_tree_ball.glb yüklenemedi:', err)
    );

    // ---------- PARTİKÜL / TOZ ----------
    const particles = new THREE.Group();
    scene.add(particles);

    const pGeo = new THREE.SphereGeometry(0.01, 6, 6);
    const pMat = new THREE.MeshBasicMaterial({ color: 0x92b3ff });

    for (let i = 0; i < 220; i++) {
      const p = new THREE.Mesh(pGeo, pMat);
      p.position.set(
        (Math.random() - 0.5) * 8,
        Math.random() * 4 - 1,
        (Math.random() - 0.5) * 6
      );
      particles.add(p);
    }

    // ---------- MOUSE PARALLAX ----------
    let mouseX = 0, mouseY = 0;

    window.addEventListener('mousemove', (e) => {
      const nx = (e.clientX / window.innerWidth) * 2 - 1;
      const ny = (e.clientY / window.innerHeight) * 2 - 1;
      mouseX = nx;
      mouseY = ny;
    });

    // ---------- ANİMASYON DÖNGÜSÜ ----------
    function animate() {
      requestAnimationFrame(animate);

      // kamera / grup hafif hareket
      group.rotation.y += 0.003;
      group.rotation.x += 0.0015;

      const targetX = mouseX * 0.4;
      const targetY = mouseY * 0.2;
      camera.position.x += (targetX - camera.position.x) * 0.04;
      camera.position.y += (-targetY + 0.8 - camera.position.y) * 0.04;
      camera.lookAt(0, 0, 0);

      particles.rotation.y += 0.0007;

      controls.update();
      renderer.render(scene, camera);
    }

    animate();

    // ---------- RESIZE ----------
    window.addEventListener('resize', () => {
      const w = window.innerWidth;
      const h = window.innerHeight;
      camera.aspect = w / h;
      camera.updateProjectionMatrix();
      renderer.setSize(w, h);
    });
  </script>
</body>
</html>
